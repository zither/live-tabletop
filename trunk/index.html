<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<link rel="shortcut icon" href="icon.gif" />
<link href="style.css" rel="stylesheet" type="text/css">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title> Live Tabletop </title>

<script type="text/javascript">
var blankObject = document.createElement('div');
blankObject.setAttribute('style', "top: 0px; left 0px;");
var selectedPanel = blankObject;
var selectedBR = blankObject;
var selectedTL = blankObject;
var selectedBar = blankObject;
var selectedIW = blankObject;
var dragX = 0;
var dragY = 0;
var clickX = 0;
var clickY = 0;
var clickDragGap = 0;
var clickDragGap = 0;
var z = 100;
var invertResize = 1;

function createPanel(outerPanel, panelName, xPos, yPos, panelWidth, panelHeight) {
    outerPanel.setAttribute('class', 'outerPanel');
    outerPanel.setAttribute('style', 'left: ' + xPos + 'px; top: ' + yPos + 
	'px; visibility: hidden;');
	outerPanel.onmousedown = function(){ panelForward(outerPanel); };
	document.body.appendChild(outerPanel);
	
      var panelTitle = document.createElement('div');
      panelTitle.setAttribute('class', 'title');	
        var resizeTL = document.createElement('div');
        resizeTL.setAttribute('class', 'resizeTL');
        var titleStart = document.createElement('div');
        titleStart.setAttribute('class', 'titleStart');
        var titleCaption = document.createElement('div');
        titleCaption.setAttribute('class', 'titleCaption');
        var titleEnd = document.createElement('div');
        titleEnd.setAttribute('class', 'titleEnd');
        var panelBar = document.createElement('div');
        panelBar.setAttribute('class', 'panelBar');
        panelBar.setAttribute('style', 'width: ' + (panelWidth - 36) + 'px;');
        var panelClose = document.createElement('div');
        panelClose.setAttribute('class', 'close');
	    panelClose.onmouseover = function(){ this.style.backgroundImage = 'url(images/closeHover.png)'; };
	    panelClose.onmouseout = function(){ this.style.backgroundImage = 'url(images/close.png)'; };
	    outerPanel.appendChild(panelTitle);
	    panelTitle.appendChild(resizeTL);
	    panelTitle.appendChild(titleStart);
	    panelTitle.appendChild(titleCaption);
        titleCaption.appendChild(document.createTextNode(panelName));
	    panelTitle.appendChild(titleEnd);
	    panelTitle.appendChild(panelBar);
        panelBar.appendChild(document.createTextNode(" "));
	    panelTitle.appendChild(panelClose);
	
      var innerPanel = document.createElement('div');
      innerPanel.setAttribute('class', 'innerPanel');
      innerPanel.setAttribute('style', 'width: ' + panelWidth + 'px; height: ' + 
	    panelHeight + 'px;');
	  var panelBottom = document.createElement('div')
      panelBottom.setAttribute('class', 'panelBottom');
      outerPanel.appendChild(innerPanel);
      innerPanel.appendChild(document.createTextNode("stuff"));
      outerPanel.appendChild(panelBottom);
	    var panelBL = document.createElement('div')
        panelBL.setAttribute('class', 'panelBL');
	    var panelBR = document.createElement('div')
        panelBR.setAttribute('class', 'resizeBR');
		panelBottom.appendChild(panelBL);
		panelBottom.appendChild(panelBR);
// Create Menu Button
    var buttonContainer = document.createElement('div');
    buttonContainer.setAttribute('class', 'buttonUnchecked');
	buttonContainer.onclick = function(){ showPanel(outerPanel, buttonContainer); };
    document.getElementById('buttons').appendChild(buttonContainer);
    panelClose.onclick = function(){ showPanel(outerPanel, buttonContainer); };
	panelBar.onmousedown = function(){ selectedPanel = outerPanel; };
	    panelBR.onmousedown = function(){ selectedBR = outerPanel; selectedIW = innerPanel};
	resizeTL.onmousedown = function(){ selectedTL = outerPanel;
      selectedBar = panelBar; selectedIW = innerPanel};
	var buttonStart = document.createElement('div')
    buttonStart.setAttribute('class', 'buttonStart');
	var buttonCaption = document.createElement('div')
    buttonCaption.setAttribute('class', 'buttonCaption');
	var buttonEnd = document.createElement('div')
    buttonEnd.setAttribute('class', 'buttonEnd');
    buttonContainer.appendChild(buttonStart);
    buttonContainer.appendChild(buttonCaption);
    buttonContainer.appendChild(buttonEnd);
    buttonCaption.appendChild(document.createTextNode(panelName));
}

onload = function (){

  var tablePanel = document.createElement('div');
  createPanel(tablePanel, 'Table', 20, 40, 175, 300)
  var chatPanel = document.createElement('div');
  createPanel(chatPanel, 'Chat', 220, 40, 175, 300)
  var turnsPanel = document.createElement('div');
  createPanel(turnsPanel, 'Turns', 420, 40, 175, 300)
  var toolsPanel = document.createElement('div');
  createPanel(toolsPanel, 'Tools', 620, 40, 175, 300)
  var filesPanel = document.createElement('div');
  createPanel(filesPanel, 'Files', 820, 40, 175, 300)
}

function showPanel(panelShow, buttonContainer){
  if(panelShow.style.visibility == "hidden"){
    panelForward(panelShow);
    buttonContainer.className = "buttonChecked";
    panelShow.style.visibility = "visible";
  }else{
    buttonContainer.className = "buttonUnchecked";
    panelShow.style.visibility = "hidden";
  }
}

document.onmouseup = unSelect;

function unSelect(){
  selectedPanel = blankObject;
  selectedBR = blankObject;
  selectedTL = blankObject;
  clickDragGap = 0;
  return true
}
//DRAGGING -----------------------------------------------------------------------
// Detect if the browser is IE or not.
// If it is not IE, we assume that the browser is NS.
var IE = document.all?true:false;
// If NS -- that is, !IE -- then set up for mouse capture
if (!IE) document.captureEvents(Event.MOUSEMOVE)
// Set-up to use getMouseXY function onMouseMove
document.onmousemove = getMouseXY;

function getMouseXY(e) {
  if (IE) { // grab the x-y pos.s if browser is IE
    dragX = event.clientX + document.body.scrollLeft;
    dragY = event.clientY + document.body.scrollTop;
  } else {  // grab the x-y pos.s if browser is NS
    dragX = e.pageX;
    dragY = e.pageY;
  }
  
  if( selectedPanel != blankObject ){
    movePanel();
  }
  if( selectedBR != blankObject ){
    resizePanel();
  }
  if( selectedTL != blankObject ){
    resizeMove();
  }
}
function movePanel(){
  w = selectedPanel;
  if( clickDragGap == 0 ) {
    clickY = dragY - parseInt(w.style.top);
    clickX = dragX - parseInt(w.style.left);
    clickDragGap = 1;
  }
  dragX = dragX - clickX;
  dragY = dragY - clickY;
  if (dragY < 0){dragY = 0;}
  if (dragX < 0){dragX = 0;}
  if (dragX > document.body.clientWidth - 40){
  dragX = document.body.clientWidth - 40;}
  if (dragY > document.body.clientHeight - 40){
  dragY = document.body.clientHeight - 40;}
  w.style.top  = dragY + "px";
  w.style.left = dragX + "px";
  // lock to grid
  //locX = (dragX / ' . $configTileWidth . ') + 1;
  //locY = (dragY / ' . $configTileHeight . ');
  return true
}
function resizePanel(){
  w = selectedIW;
  bar = selectedBar;
  if( clickDragGap == 0 ) {
    clickY = dragY - parseInt(w.style.height);
    clickX = dragX - parseInt(w.style.width);
    clickDragGap = 1;
  }
  dragX = dragX - clickX;
  dragY = dragY - clickY;
  if (dragY < 100){dragY = 100;}
  if (dragX < 100){dragX = 100;}
  w.style.height  = dragY + "px";
  w.style.width = dragX + "px";
  bar.style.width = (dragX - 36) + "px";
  return true
}
function resizeMove(){
  p = selectedTL;
  w = selectedIW;
  bar = selectedBar;
  if( clickDragGap == 0 ) {
    clickY = dragY - parseInt(p.style.top);
    clickX = dragX - parseInt(p.style.left);
    clickCornerY = dragY + parseInt(w.style.height);
    clickCornerX = dragX + parseInt(w.style.width);
    clickDragGap = 1;
  }
  
  if (dragX < 0){dragX = 0;}
  if (dragY < 0){dragY = 0;}
  if (dragX > clickCornerX - 100){dragX = clickCornerX - 100;}
  if (dragY > clickCornerY - 100){dragY = clickCornerY - 100;}
  if (dragX > document.body.clientWidth - 40){
  dragX = document.body.clientWidth - 40;}
  if (dragY > document.body.clientHeight - 40){
  dragY = document.body.clientHeight - 40;}
	
  p.style.left = (dragX - clickX) + "px";
  p.style.top  = (dragY - clickY) + "px";
  w.style.width = (clickCornerX - dragX) + "px";
  w.style.height  = (clickCornerY - dragY) + "px";
  bar.style.width = (clickCornerX - dragX - 36) + "px";
  return true
}
function panelForward(panelFront){
  document.body.removeChild(panelFront);
  document.body.appendChild(panelFront);
}
</script>

</head>
<body>

<div id="tabletop"></div>

<div id="pageBar">
	<div id="logo"></div>
	<div id="buttons"></div>
</div>

</body>
<html>